function cov_2riyrhfjlx() {
  var path = "H:\\Michele\\Universit\xE0\\Magistrale Polito\\Software Engineering II\\SPG\\SPG\\client\\src\\api\\unretrieved.js";
  var hash = "f11a1dec29606d3a78a83bf25ddc5f1bbc7dec83";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "H:\\Michele\\Universit\xE0\\Magistrale Polito\\Software Engineering II\\SPG\\SPG\\client\\src\\api\\unretrieved.js",
    statementMap: {
      "0": {
        start: {
          line: 4,
          column: 0
        },
        end: {
          line: 4,
          column: 25
        }
      },
      "1": {
        start: {
          line: 10,
          column: 21
        },
        end: {
          line: 10,
          column: 61
        }
      },
      "2": {
        start: {
          line: 11,
          column: 25
        },
        end: {
          line: 11,
          column: 46
        }
      },
      "3": {
        start: {
          line: 12,
          column: 4
        },
        end: {
          line: 16,
          column: 5
        }
      },
      "4": {
        start: {
          line: 13,
          column: 7
        },
        end: {
          line: 13,
          column: 156
        }
      },
      "5": {
        start: {
          line: 13,
          column: 37
        },
        end: {
          line: 13,
          column: 153
        }
      },
      "6": {
        start: {
          line: 15,
          column: 7
        },
        end: {
          line: 15,
          column: 26
        }
      },
      "7": {
        start: {
          line: 21,
          column: 21
        },
        end: {
          line: 35,
          column: 6
        }
      },
      "8": {
        start: {
          line: 21,
          column: 65
        },
        end: {
          line: 35,
          column: 6
        }
      },
      "9": {
        start: {
          line: 23,
          column: 22
        },
        end: {
          line: 24,
          column: 221
        }
      },
      "10": {
        start: {
          line: 24,
          column: 12
        },
        end: {
          line: 24,
          column: 219
        }
      },
      "11": {
        start: {
          line: 25,
          column: 8
        },
        end: {
          line: 34,
          column: 16
        }
      },
      "12": {
        start: {
          line: 26,
          column: 12
        },
        end: {
          line: 27,
          column: 138
        }
      },
      "13": {
        start: {
          line: 26,
          column: 37
        },
        end: {
          line: 27,
          column: 136
        }
      },
      "14": {
        start: {
          line: 27,
          column: 69
        },
        end: {
          line: 27,
          column: 92
        }
      },
      "15": {
        start: {
          line: 30,
          column: 12
        },
        end: {
          line: 34,
          column: 16
        }
      },
      "16": {
        start: {
          line: 37,
          column: 22
        },
        end: {
          line: 37,
          column: 62
        }
      }
    },
    fnMap: {
      "0": {
        name: "getUnretrievedProducts",
        decl: {
          start: {
            line: 8,
            column: 15
          },
          end: {
            line: 8,
            column: 37
          }
        },
        loc: {
          start: {
            line: 8,
            column: 40
          },
          end: {
            line: 17,
            column: 1
          }
        },
        line: 8
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 13,
            column: 31
          },
          end: {
            line: 13,
            column: 32
          }
        },
        loc: {
          start: {
            line: 13,
            column: 37
          },
          end: {
            line: 13,
            column: 153
          }
        },
        line: 13
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 21,
            column: 21
          },
          end: {
            line: 21,
            column: 22
          }
        },
        loc: {
          start: {
            line: 21,
            column: 65
          },
          end: {
            line: 35,
            column: 6
          }
        },
        line: 21
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 21,
            column: 81
          },
          end: {
            line: 21,
            column: 82
          }
        },
        loc: {
          start: {
            line: 21,
            column: 95
          },
          end: {
            line: 35,
            column: 1
          }
        },
        line: 21
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 23,
            column: 36
          },
          end: {
            line: 23,
            column: 37
          }
        },
        loc: {
          start: {
            line: 24,
            column: 12
          },
          end: {
            line: 24,
            column: 219
          }
        },
        line: 24
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 26,
            column: 27
          },
          end: {
            line: 26,
            column: 28
          }
        },
        loc: {
          start: {
            line: 26,
            column: 37
          },
          end: {
            line: 27,
            column: 136
          }
        },
        line: 26
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 27,
            column: 64
          },
          end: {
            line: 27,
            column: 65
          }
        },
        loc: {
          start: {
            line: 27,
            column: 69
          },
          end: {
            line: 27,
            column: 92
          }
        },
        line: 27
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 12,
            column: 4
          },
          end: {
            line: 16,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 12,
            column: 4
          },
          end: {
            line: 16,
            column: 5
          }
        }, {
          start: {
            line: 12,
            column: 4
          },
          end: {
            line: 16,
            column: 5
          }
        }],
        line: 12
      },
      "1": {
        loc: {
          start: {
            line: 21,
            column: 38
          },
          end: {
            line: 21,
            column: 60
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 21,
            column: 56
          },
          end: {
            line: 21,
            column: 60
          }
        }],
        line: 21
      },
      "2": {
        loc: {
          start: {
            line: 24,
            column: 12
          },
          end: {
            line: 24,
            column: 219
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 24,
            column: 13
          },
          end: {
            line: 24,
            column: 122
          }
        }, {
          start: {
            line: 24,
            column: 127
          },
          end: {
            line: 24,
            column: 170
          }
        }, {
          start: {
            line: 24,
            column: 175
          },
          end: {
            line: 24,
            column: 198
          }
        }, {
          start: {
            line: 24,
            column: 202
          },
          end: {
            line: 24,
            column: 218
          }
        }],
        line: 24
      },
      "3": {
        loc: {
          start: {
            line: 24,
            column: 13
          },
          end: {
            line: 24,
            column: 122
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 24,
            column: 31
          },
          end: {
            line: 24,
            column: 74
          }
        }, {
          start: {
            line: 24,
            column: 77
          },
          end: {
            line: 24,
            column: 122
          }
        }],
        line: 24
      },
      "4": {
        loc: {
          start: {
            line: 25,
            column: 8
          },
          end: {
            line: 34,
            column: 16
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 25,
            column: 8
          },
          end: {
            line: 34,
            column: 16
          }
        }, {
          start: {
            line: 25,
            column: 8
          },
          end: {
            line: 34,
            column: 16
          }
        }],
        line: 25
      },
      "5": {
        loc: {
          start: {
            line: 26,
            column: 37
          },
          end: {
            line: 27,
            column: 136
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 26,
            column: 51
          },
          end: {
            line: 26,
            column: 52
          }
        }, {
          start: {
            line: 27,
            column: 16
          },
          end: {
            line: 27,
            column: 136
          }
        }],
        line: 26
      },
      "6": {
        loc: {
          start: {
            line: 31,
            column: 23
          },
          end: {
            line: 31,
            column: 110
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 31,
            column: 42
          },
          end: {
            line: 31,
            column: 75
          }
        }, {
          start: {
            line: 31,
            column: 78
          },
          end: {
            line: 31,
            column: 110
          }
        }],
        line: 31
      },
      "7": {
        loc: {
          start: {
            line: 33,
            column: 20
          },
          end: {
            line: 33,
            column: 119
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 33,
            column: 38
          },
          end: {
            line: 33,
            column: 114
          }
        }, {
          start: {
            line: 33,
            column: 117
          },
          end: {
            line: 33,
            column: 119
          }
        }],
        line: 33
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0
    },
    b: {
      "0": [0, 0],
      "1": [0],
      "2": [0, 0, 0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "f11a1dec29606d3a78a83bf25ddc5f1bbc7dec83"
  };
  var coverage = global[gcv] || (global[gcv] = {});

  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }

  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_2riyrhfjlx = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}

cov_2riyrhfjlx();
import dayjs from "dayjs";
import weekOfYear from 'dayjs/plugin/weekOfYear';
cov_2riyrhfjlx().s[0]++;
dayjs.extend(weekOfYear);
/* Return the unretrieved products as an array of objects like 
   {product_id: 0, timestamp: 0, client: 'client@demo.it', quantity: 0, name: 'apple', farmer: 'farmer@demo.it'} */

async function getUnretrievedProducts() {
  cov_2riyrhfjlx().f[0]++;
  // call: GET /api/products
  const response = (cov_2riyrhfjlx().s[1]++, await fetch('/api/products/unretrieved'));
  const productsJson = (cov_2riyrhfjlx().s[2]++, await response.json());
  cov_2riyrhfjlx().s[3]++;

  if (response.ok) {
    cov_2riyrhfjlx().b[0][0]++;
    cov_2riyrhfjlx().s[4]++;
    return productsJson.map(p => {
      cov_2riyrhfjlx().f[1]++;
      cov_2riyrhfjlx().s[5]++;
      return {
        product_id: p.id,
        timestamp: p.timestamp,
        quantity: p.quantity,
        name: p.name,
        farmer: p.farmer,
        client: p.client
      };
    });
  } else {
    cov_2riyrhfjlx().b[0][1]++;
    cov_2riyrhfjlx().s[6]++;
    throw productsJson; // an object with the error coming from the server
  }
}
/* Receive an array of products and return the monthly or weekly (according to the value of base) statistics of unretrieved products, 
   return an array of objects like {product_id: 0, month/week: 0, year: 2022, name: 'apple', quantity: 0, farmer: 'farmer@demo.it'} */


cov_2riyrhfjlx().s[7]++;

const getSatistics = (products, base, single_products = (cov_2riyrhfjlx().b[1][0]++, true)) => {
  cov_2riyrhfjlx().f[2]++;
  cov_2riyrhfjlx().s[8]++;
  return products.reduce((prv, crr) => {
    cov_2riyrhfjlx().f[3]++;
    //get the index of the current product for the related month/week
    const index = (cov_2riyrhfjlx().s[9]++, prv.findIndex(e => {
      cov_2riyrhfjlx().f[4]++;
      cov_2riyrhfjlx().s[10]++;
      return (cov_2riyrhfjlx().b[2][0]++, base === 'week' ? (cov_2riyrhfjlx().b[3][0]++, e.week === dayjs.unix(crr.timestamp).week()) : (cov_2riyrhfjlx().b[3][1]++, e.month === dayjs.unix(crr.timestamp).month())) && (cov_2riyrhfjlx().b[2][1]++, e.year === dayjs.unix(crr.timestamp).year()) && ((cov_2riyrhfjlx().b[2][2]++, e.product_id === crr.id) || (cov_2riyrhfjlx().b[2][3]++, !single_products));
    }));
    cov_2riyrhfjlx().s[11]++;

    if (index >= 0) {
      cov_2riyrhfjlx().b[4][0]++;
      cov_2riyrhfjlx().s[12]++;
      //the product has already been considered for the corresponding month
      return prv.map((e, i) => {
        cov_2riyrhfjlx().f[5]++;
        cov_2riyrhfjlx().s[13]++;
        return i !== index ? (cov_2riyrhfjlx().b[5][0]++, e) : (cov_2riyrhfjlx().b[5][1]++, Object.fromEntries([...Object.entries(e).filter(k => {
          cov_2riyrhfjlx().f[6]++;
          cov_2riyrhfjlx().s[14]++;
          return !k.includes('quantity');
        }), ['quantity', e.quantity + crr.quantity]]));
      });
    } //return the same objects with the incremented quantity
    else {
      cov_2riyrhfjlx().b[4][1]++;
      cov_2riyrhfjlx().s[15]++;
      //add a new object to the array
      return [...prv, Object.fromEntries([[base, base === 'month' ? (cov_2riyrhfjlx().b[6][0]++, dayjs.unix(crr.timestamp).month()) : (cov_2riyrhfjlx().b[6][1]++, dayjs.unix(crr.timestamp).week())], ["year", dayjs.unix(crr.timestamp).year()], ["quantity", crr.quantity], ...(single_products ? (cov_2riyrhfjlx().b[7][0]++, [["product_id", crr.product_id], ["name", crr.name], ["farmer", crr.farmer]]) : (cov_2riyrhfjlx().b[7][1]++, []))])];
    }
  }, []);
};

const unrtrievedAPI = (cov_2riyrhfjlx().s[16]++, {
  getUnretrievedProducts,
  getSatistics
});
export default unrtrievedAPI;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVucmV0cmlldmVkLmpzIl0sIm5hbWVzIjpbImRheWpzIiwid2Vla09mWWVhciIsImV4dGVuZCIsImdldFVucmV0cmlldmVkUHJvZHVjdHMiLCJyZXNwb25zZSIsImZldGNoIiwicHJvZHVjdHNKc29uIiwianNvbiIsIm9rIiwibWFwIiwicCIsInByb2R1Y3RfaWQiLCJpZCIsInRpbWVzdGFtcCIsInF1YW50aXR5IiwibmFtZSIsImZhcm1lciIsImNsaWVudCIsImdldFNhdGlzdGljcyIsInByb2R1Y3RzIiwiYmFzZSIsInNpbmdsZV9wcm9kdWN0cyIsInJlZHVjZSIsInBydiIsImNyciIsImluZGV4IiwiZmluZEluZGV4IiwiZSIsIndlZWsiLCJ1bml4IiwibW9udGgiLCJ5ZWFyIiwiaSIsIk9iamVjdCIsImZyb21FbnRyaWVzIiwiZW50cmllcyIsImZpbHRlciIsImsiLCJpbmNsdWRlcyIsInVucnRyaWV2ZWRBUEkiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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QUFFQSxlQUFlcUIsYUFBZiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBkYXlqcyBmcm9tIFwiZGF5anNcIjtcclxuaW1wb3J0IHdlZWtPZlllYXIgZnJvbSAnZGF5anMvcGx1Z2luL3dlZWtPZlllYXInXHJcblxyXG5kYXlqcy5leHRlbmQod2Vla09mWWVhcik7XHJcblxyXG4vKiBSZXR1cm4gdGhlIHVucmV0cmlldmVkIHByb2R1Y3RzIGFzIGFuIGFycmF5IG9mIG9iamVjdHMgbGlrZSBcclxuICAge3Byb2R1Y3RfaWQ6IDAsIHRpbWVzdGFtcDogMCwgY2xpZW50OiAnY2xpZW50QGRlbW8uaXQnLCBxdWFudGl0eTogMCwgbmFtZTogJ2FwcGxlJywgZmFybWVyOiAnZmFybWVyQGRlbW8uaXQnfSAqL1xyXG5hc3luYyBmdW5jdGlvbiBnZXRVbnJldHJpZXZlZFByb2R1Y3RzKCkge1xyXG4gICAgLy8gY2FsbDogR0VUIC9hcGkvcHJvZHVjdHNcclxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvcHJvZHVjdHMvdW5yZXRyaWV2ZWQnKTtcclxuICAgIGNvbnN0IHByb2R1Y3RzSnNvbiA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuICAgIGlmIChyZXNwb25zZS5vaykge1xyXG4gICAgICBcdHJldHVybiBwcm9kdWN0c0pzb24ubWFwKHAgPT4gKHsgcHJvZHVjdF9pZDogcC5pZCwgdGltZXN0YW1wOiBwLnRpbWVzdGFtcCwgcXVhbnRpdHk6IHAucXVhbnRpdHksIG5hbWU6IHAubmFtZSwgZmFybWVyOiBwLmZhcm1lciwgY2xpZW50OiBwLmNsaWVudCB9KSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBcdHRocm93IHByb2R1Y3RzSnNvbjsgIC8vIGFuIG9iamVjdCB3aXRoIHRoZSBlcnJvciBjb21pbmcgZnJvbSB0aGUgc2VydmVyXHJcbiAgICB9XHJcbn1cclxuXHJcbi8qIFJlY2VpdmUgYW4gYXJyYXkgb2YgcHJvZHVjdHMgYW5kIHJldHVybiB0aGUgbW9udGhseSBvciB3ZWVrbHkgKGFjY29yZGluZyB0byB0aGUgdmFsdWUgb2YgYmFzZSkgc3RhdGlzdGljcyBvZiB1bnJldHJpZXZlZCBwcm9kdWN0cywgXHJcbiAgIHJldHVybiBhbiBhcnJheSBvZiBvYmplY3RzIGxpa2Uge3Byb2R1Y3RfaWQ6IDAsIG1vbnRoL3dlZWs6IDAsIHllYXI6IDIwMjIsIG5hbWU6ICdhcHBsZScsIHF1YW50aXR5OiAwLCBmYXJtZXI6ICdmYXJtZXJAZGVtby5pdCd9ICovXHJcbmNvbnN0IGdldFNhdGlzdGljcyA9IChwcm9kdWN0cywgYmFzZSwgc2luZ2xlX3Byb2R1Y3RzID0gdHJ1ZSkgPT4gcHJvZHVjdHMucmVkdWNlKChwcnYsIGNycikgPT4ge1xyXG4gICAgICAgIC8vZ2V0IHRoZSBpbmRleCBvZiB0aGUgY3VycmVudCBwcm9kdWN0IGZvciB0aGUgcmVsYXRlZCBtb250aC93ZWVrXHJcbiAgICAgICAgY29uc3QgaW5kZXggPSBwcnYuZmluZEluZGV4KGUgPT4gXHJcbiAgICAgICAgICAgIChiYXNlID09PSAnd2VlaycgPyBlLndlZWsgPT09IGRheWpzLnVuaXgoY3JyLnRpbWVzdGFtcCkud2VlaygpIDogZS5tb250aCA9PT0gZGF5anMudW5peChjcnIudGltZXN0YW1wKS5tb250aCgpKSAmJiBlLnllYXIgPT09IGRheWpzLnVuaXgoY3JyLnRpbWVzdGFtcCkueWVhcigpICYmIChlLnByb2R1Y3RfaWQgPT09IGNyci5pZCB8fCAhc2luZ2xlX3Byb2R1Y3RzKSApO1xyXG4gICAgICAgIGlmKGluZGV4ID49IDApIC8vdGhlIHByb2R1Y3QgaGFzIGFscmVhZHkgYmVlbiBjb25zaWRlcmVkIGZvciB0aGUgY29ycmVzcG9uZGluZyBtb250aFxyXG4gICAgICAgICAgICByZXR1cm4gcHJ2Lm1hcCgoZSwgaSkgPT4gaSAhPT0gaW5kZXggPyBlIDogXHJcbiAgICAgICAgICAgICAgICBPYmplY3QuZnJvbUVudHJpZXMoWy4uLk9iamVjdC5lbnRyaWVzKGUpLmZpbHRlcihrID0+ICFrLmluY2x1ZGVzKCdxdWFudGl0eScpKSwgWydxdWFudGl0eScsIGUucXVhbnRpdHkgKyBjcnIucXVhbnRpdHldXSkpO1xyXG4gICAgICAgICAgICAgICAgLy9yZXR1cm4gdGhlIHNhbWUgb2JqZWN0cyB3aXRoIHRoZSBpbmNyZW1lbnRlZCBxdWFudGl0eVxyXG4gICAgICAgIGVsc2UgLy9hZGQgYSBuZXcgb2JqZWN0IHRvIHRoZSBhcnJheVxyXG4gICAgICAgICAgICByZXR1cm4gWy4uLnBydiwgT2JqZWN0LmZyb21FbnRyaWVzKFtcclxuICAgICAgICAgICAgICAgIFtiYXNlLCBiYXNlID09PSAnbW9udGgnID8gZGF5anMudW5peChjcnIudGltZXN0YW1wKS5tb250aCgpIDogZGF5anMudW5peChjcnIudGltZXN0YW1wKS53ZWVrKCldLFxyXG4gICAgICAgICAgICAgICAgW1wieWVhclwiLCBkYXlqcy51bml4KGNyci50aW1lc3RhbXApLnllYXIoKV0sIFtcInF1YW50aXR5XCIsIGNyci5xdWFudGl0eV0sXHJcbiAgICAgICAgICAgICAgICAuLi4oc2luZ2xlX3Byb2R1Y3RzID8gW1tcInByb2R1Y3RfaWRcIiwgY3JyLnByb2R1Y3RfaWRdLCBbXCJuYW1lXCIsIGNyci5uYW1lXSwgW1wiZmFybWVyXCIsIGNyci5mYXJtZXJdXSA6IFtdKVxyXG4gICAgICAgICAgICBdKV07XHJcbn0sIFtdKTtcclxuXHJcbmNvbnN0IHVucnRyaWV2ZWRBUEkgPSB7IGdldFVucmV0cmlldmVkUHJvZHVjdHMsIGdldFNhdGlzdGljcyB9XHJcblxyXG5leHBvcnQgZGVmYXVsdCB1bnJ0cmlldmVkQVBJOyJdfQ==